<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1e24">
  <title>Celio's Network Machine</title>
  <link rel="stylesheet" href="xterm.css">
  <link rel="stylesheet" href="style.css?v=44">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <div id="header-left">
        <div id="title-block">
          <span class="title-main">CELIO'S</span>
          <span class="title-sub">NETWORK MACHINE</span>
        </div>
      </div>
      <div id="connection-status">
        <span class="status-gem gem-ruby"></span>
        <span class="status-text">Connecting</span>
        <span class="status-gem gem-sapphire"></span>
      </div>
    </header>

    <!-- View Toggle -->
    <div id="view-controls">
      <button class="view-btn active" data-view="dashboard" title="Dashboard">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="3" width="7" height="7" rx="1"/>
          <rect x="14" y="3" width="7" height="7" rx="1"/>
          <rect x="3" y="14" width="7" height="7" rx="1"/>
          <rect x="14" y="14" width="7" height="7" rx="1"/>
        </svg>
      </button>
      <button class="view-btn" data-view="split" title="Split View">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="3" width="8" height="18" rx="1"/>
          <rect x="13" y="3" width="8" height="18" rx="1"/>
        </svg>
      </button>
      <button class="view-btn" data-view="focus" title="Focus Mode">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
        </svg>
      </button>
      <button id="refresh-btn" title="Refresh Sessions">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
        </svg>
      </button>
    </div>

    <!-- Dashboard View (Session Cards) -->
    <div id="dashboard-view" class="view active">
      <div id="session-cards"></div>
      <div id="no-sessions" class="empty-state">
        <div class="empty-icon">
          <svg width="56" height="56" viewBox="0 0 256 256" fill="currentColor" opacity="0.35">
            <path id="empty-icon-path" d="m 128,38.17189 c -3.96774,0 -7.88276,0.26235 -11.71455,0.76112 l 0,107.94597 99.54061,0 c 1.29999,-6.08286 1.98552,-12.39119 1.98552,-18.86242 0,-49.6066 -40.20496,-89.84467 -89.81158,-89.84467 z m -57.282183,20.61629 c -19.888889,16.47529 -32.529397,41.38427 -32.529397,69.22838 0,6.46737 0.689185,12.78339 1.985518,18.86242 l 30.543879,0 0,-88.0908 z M 45.865755,164.45081 c 5.665734,12.76396 14.229794,23.96191 24.852062,32.76104 l 0,-32.76104 -24.852062,0 z m 70.419695,0 0,52.61621 c 3.83198,0.4988 7.7466,0.7611 11.71455,0.7611 36.63278,0 68.12716,-21.93201 82.10115,-53.37731 l -93.8157,0 z"/>
          </svg>
        </div>
        <p id="agent-count">Waiting for connection</p>
        <p class="hint">Start a link with: <code>node launcher.js &lt;name&gt; [dir]</code></p>
      </div>
    </div>

    <!-- Split View (2-4 terminals) -->
    <div id="split-view" class="view">
      <div id="split-container"></div>
    </div>

    <!-- Focus View (Single terminal with input) -->
    <div id="focus-view" class="view">
      <div id="focus-header">
        <button id="back-btn" title="Back to dashboard">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
          </svg>
        </button>
        <div id="focus-session-info">
          <span id="focus-session-name">Session</span>
          <span id="focus-session-status" class="status-badge">Connected</span>
        </div>
        <!-- Control buttons in header - always visible -->
        <div id="header-controls">
          <button class="header-ctrl-btn" data-key="ESC" title="Escape">ESC</button>
          <button class="header-ctrl-btn" data-key="CTRL_C" title="Interrupt">^C</button>
          <button class="header-ctrl-btn" data-key="CTRL_D" title="EOF">^D</button>
        </div>
        <button id="expand-btn" title="Toggle fullscreen">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
          </svg>
        </button>
      </div>
      <div id="focus-terminal"></div>
      <div id="input-bar">
        <div id="tap-to-type">Tap terminal to type</div>
        <button id="keyboard-toggle" title="Toggle keyboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Hidden input for iOS keyboard -->
    <input type="text" id="hidden-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  </div>

  <script src="xterm.min.js"></script>
  <script src="xterm-addon-fit.min.js"></script>
  <script src="xterm-addon-web-links.min.js"></script>
  <script src="icons.js?v=2"></script>
  <script src="app.js?v=42"></script>
</body>
</html>
